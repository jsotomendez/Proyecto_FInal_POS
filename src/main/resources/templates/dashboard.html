<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" th:replace="~{fragments/base :: main-layout(title='Dashboard', content=~{::#dash-content})}">
<body>
<div id="dash-content">
    <h2 class="mb-4">ðŸ“Š Tablero de Control</h2>
    <div class="row mb-4">
        <div class="col-md-3"><div class="card text-white bg-primary h-100"><div class="card-body"><h5>Ventas Hoy</h5><h2 th:text="${stats.totalVentasDia}">0</h2></div></div></div>
        <div class="col-md-3"><div class="card text-white bg-success h-100"><div class="card-body"><h5>Ingresos</h5><h2 th:text="${'$ ' + stats.ingresosDia}">0</h2></div></div></div>
        <div class="col-md-3"><div class="card text-white bg-danger h-100"><div class="card-body"><h5>Bajo Stock</h5><h2 th:text="${stats.productosBajoStock}">0</h2></div></div></div>
        <div class="col-md-3"><div class="card text-white bg-info h-100"><div class="card-body"><h5>Clientes</h5><h2 th:text="${stats.clientesRegistrados}">0</h2></div></div></div>
    </div>
    <div class="row">
        <div class="col-md-8"><div class="card shadow"><div class="card-body"><canvas id="chartVentas"></canvas></div></div></div>
        <div class="col-md-4"><div class="card shadow"><div class="card-body"><canvas id="chartProductos"></canvas></div></div></div>
    </div>
    <script th:inline="javascript">
        var fechas = /*[[${graficoVentas}]]*/ [].map(x=>x[0]).reverse();
        var totales = /*[[${graficoVentas}]]*/ [].map(x=>x[1]).reverse();
        new Chart(document.getElementById('chartVentas'), {type:'line', data:{labels:fechas, datasets:[{label:'Ingresos', data:totales, borderColor:'#e67e22', backgroundColor:'rgba(230,126,34,0.1)', fill:true}]}});

        var pNom = /*[[${graficoProductos}]]*/ [].map(x=>x[0]);
        var pCant = /*[[${graficoProductos}]]*/ [].map(x=>x[1]);
        new Chart(document.getElementById('chartProductos'), {type:'doughnut', data:{labels:pNom, datasets:[{data:pCant, backgroundColor:['#2c3e50','#e67e22','#34495e','#d35400','#95a5a6']}]}});
    </script>
</div>
</body>
</html>